#!/usr/bin/make -f
export CI=true 
export DOTNET_CLI_TELEMETRY_OPTOUT=1

%:
	dh $@

override_dh_auto_build:
	cd src/Nethermind/Nethermind.Runner && dotnet build -c release
	# Delete all other archs then x64
	find src/Nethermind/artifacts/bin/Nethermind.Runner/release/runtimes -mindepth 1 -maxdepth 1 -type d ! -name 'linux-x86_64' -exec rm -r {} \;
	find src/Nethermind/artifacts/obj -type f -name '*.AssemblyReference.cache' -delete

# TODO fix tests
override_dh_auto_test:
	# # Skip tests as they are failing
	# # Run Nethermind tests:
	# cd src/Nethermind && dotnet test Nethermind.sln -c release
	# # Run Ethereum Foundation tests:
	# cd src/Nethermind && dotnet test EthereumTests.sln -c release


override_dh_auto_clean:
	# on ubuntu clean fails, before dependency installation
	# on bookworm clean succeeds, even if dependency is not installed
	-make -j1 clean


override_dh_dwz:
	# skip of optimization of DWARF debug information in ELF binaries via dwz
